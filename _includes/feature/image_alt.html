{% comment %}

    Image embed from an item's objectid.
    This include adds a figure to the page styled using bootstrap, https://getbootstrap.com/docs/4.5/content/figures/
    It requires an "objectid" with the include, which is used to find the object title and image (for image or youtube objects).
    If multiple objectids are included (separated by ; ), they will be added to a "col-md" in a row which will automatically divided equally. 

    E.G. --> {% include feature/image.html objectid="demo_001" %}

    Options: 
    - "objectid" = several options below (required)
        1. one or more objectids from this collection, separated by semicolon, e.g. "demo_001" or "demo_001;demo_005"
        2.  a full URL to an external image file, e.g. "https://www.lib.uidaho.edu/digital/videos/fluffyclouds.mp4"
        3. a relative link to an image file stored in this repository (that is not included in the collection), i.e. "/assets/img/evan.jpg"  
        IMPORTANT NOTE: Options 2 and 3 require you to add a caption or cpations in order to allow for the accessibilty enabled by the "alt" tag
    - "caption" = by default the figure include automatically adds the title of the item from your metadata. The caption option allows you to manually add a different caption, or give the value false for none. (optional)
    - "width" = will use responsive sizing to set the % size on desktop (will be 100% on mobile), choose from "25", "50", "75", or "100" (optional)
    - "float" = will use responsive float utility to add float on desktop (will not float on mobile), choose from "left" or "right" (optional, not recommended) If you use the "float" option, you may want to "clear" the float at some point below, by adding <div class="clearfix"></div> to your content page.
    
{%- endcomment -%}
{%- assign figures = include.objectid | split: ";" %}
{%- assign captions = include.caption | split: ";" %}
{%- assign links = include.link | split: ";" -%}
<div class="row">
    {% for i in figures %}
    {% if i contains "/" %}
    {%- capture src -%}{{i}}{%- endcapture -%}
    {%- capture image_caption -%}{{ captions[forloop.index0] }}{%- endcapture -%}
    {%- capture image_link -%}{{ links[forloop.index0] | default: i }}{% endcapture %}
    {% else %}
    {%- assign figure = site.data[site.metadata] | where: "objectid", i | first -%}
    {%- capture image_link -%}{{'/item.html' | relative_url | append: '?id=' | append: figure.objectid }}{% endcapture %}
    {%- capture image_caption -%}{% if include.caption %}{{ captions[forloop.index0] | escape }}{% else %}{{ figure.title | escape }}{% endif %}{%- endcapture -%}
    {%- capture src -%}{% if figure.youtubeid %}{{ 'https://img.youtube.com/vi/' | append: figure.youtubeid | append: '/hqdefault.jpg' }}{% elsif  figure.filename contains '/' %}{{ figure.filename }}{% else %}{{ '/objects/' | append: figure.filename | relative_url }}{% endif %}{% endcapture %}
    {% endif %}
    <div class="col-md text-center">
        <figure class="figure mx-3{% if include.float %} feature-float-{{ include.float }}{% endif %}{% if include.width %} feature-w-{{ include.width }}{% endif %}">
            <a href="{{ image_link }}">
                <img class="figure-img img-fluid rounded lazyload" alt="{{ image_caption | default: 'an image without an alt tag!' }}" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 3 2'%3E%3C/svg%3E" data-src="{{ src }}" >
            </a>
            {% unless include.caption == false %}<figcaption class="figure-caption">{{ image_caption | default: "an image without an alt tag! add a caption to enable!"}}</figcaption>{% endunless %}
        </figure>
    </div>
    {% endfor %}
</div>
